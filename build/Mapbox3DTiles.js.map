{"version":3,"file":"Mapbox3DTiles.js","sources":["../src/Mapbox3DTiles.js"],"sourcesContent":["import { Utils } from './Utils.js';\n\t\nconst WEBMERCATOR_EXTENT = 20037508.3427892;\nconst THREE = window.THREE;\nconst DEBUG = false;\t\n\n\nclass TileSet {\n\tconstructor(){\n\t\tthis.url = null;\n\t\tthis.version = null;\n\t\tthis.gltfUpAxis = 'Z';\n\t\tthis.geometricError = null;\n\t\tthis.root = null;\n\t}\n\tload(url, styleParams) {\n\t\tthis.url = url;\n\t\tlet resourcePath = THREE.LoaderUtils.extractUrlBase(url);\n\t\tlet self = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfetch(self.url)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\tthrow new Error(`HTTP ${response.status} - ${response.statusText}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn response;\n\t\t\t\t})\n\t\t\t\t.then(response => response.json())\n\t\t\t\t.then(json => {\n\t\t\t\t\tself.version = json.asset.version;\n\t\t\t\t\tself.geometricError = json.geometricError;\n\t\t\t\t\tself.refine = json.refine ? json.refine.toUpperCase() : 'ADD';\n\t\t\t\t\tself.root = new ThreeDeeTile(json.root, resourcePath, styleParams, self.refine, true);\n\t\t\t\t})\n\t\t\t\t.then(res => resolve())\n\t\t\t\t.catch(error => {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t});\t\t\n\t}\n}\n\n\nclass ThreeDeeTile {\n\tconstructor(json, resourcePath, styleParams, parentRefine, isRoot) {\n\t\tthis.loaded = false;\n\t\tthis.styleParams = styleParams;\n\t\tthis.resourcePath = resourcePath;\n\t\tthis.totalContent = new THREE.Group();\t// Three JS Object3D Group for this tile and all its children\n\t\tthis.tileContent = new THREE.Group();\t\t// Three JS Object3D Group for this tile's content\n\t\tthis.childContent = new THREE.Group();\t\t// Three JS Object3D Group for this tile's children\n\t\tthis.totalContent.add(this.tileContent);\n\t\tthis.totalContent.add(this.childContent);\n\t\tthis.boundingVolume = json.boundingVolume;\n\t\tif (this.boundingVolume && this.boundingVolume.box) {\n\t\t\tlet b = this.boundingVolume.box;\n\t\t\tlet extent = [b[0] - b[3], b[1] - b[7], b[0] + b[3], b[1] + b[7]];\n\t\t\tlet sw = new THREE.Vector3(extent[0], extent[1], b[2] - b[11]);\n\t\t\tlet ne = new THREE.Vector3(extent[2], extent[3], b[2] + b[11]);\n\t\t\tthis.box = new THREE.Box3(sw, ne);\n\t\t\tif (DEBUG) {\n\t\t\t\tlet geom = new THREE.BoxGeometry(b[3] * 2, b[7] * 2, b[11] * 2);\n\t\t\t\tlet edges = new THREE.EdgesGeometry( geom );\n\t\t\t\tlet line = new THREE.LineSegments( edges, new THREE.LineBasicMaterial( { color: 0x800000 } ) );\n\t\t\t\tlet trans = new THREE.Matrix4().makeTranslation(b[0], b[1], b[2]);\n\t\t\t\tline.applyMatrix4(trans);\n\t\t\t\tthis.totalContent.add(line);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.extent = null;\n\t\t\tthis.sw = null;\n\t\t\tthis.ne = null;\n\t\t\tthis.box = null;\n\t\t\tthis.center = null;\n\t\t}\n\t\tthis.refine = json.refine ? json.refine.toUpperCase() : parentRefine;\n\t\tthis.geometricError = json.geometricError;\n\t\tthis.transform = json.transform;\n\t\tif (this.transform && !isRoot) { \n\t\t\t// if not the root tile: apply the transform to the THREE js Group\n\t\t\t// the root tile transform is applied to the camera while rendering\n\t\t\tthis.totalContent.applyMatrix4(new THREE.Matrix4().fromArray(this.transform));\n\t\t}\n\t\tthis.content = json.content;\n\t\tthis.children = [];\n\t\tif (json.children) {\n\t\t\tfor (let i=0; i<json.children.length; i++){\n\t\t\t\tlet child = new ThreeDeeTile(json.children[i], resourcePath, styleParams, this.refine, false);\n\t\t\t\tthis.childContent.add(child.totalContent);\n\t\t\t\tthis.children.push(child);\n\t\t\t}\n\t\t}\n\t}\n\tload() {\n\t\tthis.tileContent.visible = true;\n\t\tthis.childContent.visible = true;\n\t\tif (this.loaded) {\n\t\t\treturn;\n\t\t}\n\t\tthis.loaded = true;\n\t\tlet self = this;\n\t\tif (this.content) {\n\t\t\tlet url = this.content.uri ? this.content.uri : this.content.url;\n\t\t\tif (!url) return;\n\t\t\tif (url.substr(0, 4) != 'http')\n\t\t\t\turl = this.resourcePath + url;\n\t\t\tlet type = url.slice(-4);\n\t\t\tif (type == 'json') {\n\t\t\t\t// child is a tileset json\n\t\t\t\tlet tileset = new TileSet();\n\t\t\t\ttileset.load(url, this.styleParams).then(function(){\n\t\t\t\t\tself.children.push(tileset.root);\n\t\t\t\t\tif (tileset.root) {\n\t\t\t\t\t\tif (tileset.root.transform) {\n\t\t\t\t\t\t\t// the root tile transform of a tileset is normally not applied because\n\t\t\t\t\t\t\t// it is applied by the camera while rendering. However, in case the tileset \n\t\t\t\t\t\t\t// is a subset of another tileset, so the root tile transform must be applied \n\t\t\t\t\t\t\t// to the THREE js group of the root tile.\n\t\t\t\t\t\t\ttileset.root.totalContent.applyMatrix4(new THREE.Matrix4().fromArray(tileset.root.transform));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.childContent.add(tileset.root.totalContent);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (type == 'b3dm') {\n\t\t\t\tlet loader = new THREE.GLTFLoader();\n\t\t\t\tlet b3dm = new B3DM(url);\n\t\t\t\tlet rotateX = new THREE.Matrix4().makeRotationAxis(new THREE.Vector3(1, 0, 0), Math.PI / 2);\n\t\t\t\tself.tileContent.applyMatrix4(rotateX); // convert from GLTF Y-up to Z-up\n\t\t\t\tb3dm.load()\n\t\t\t\t\t.then(d => loader.parse(d.glbData, self.resourcePath, function(gltf) {\n\t\t\t\t\t\t\tif (self.styleParams.color != null || self.styleParams.opacity != null) {\n\t\t\t\t\t\t\t\tlet color = new THREE.Color(self.styleParams.color);\n\t\t\t\t\t\t\t\tgltf.scene.traverse(child => {\n\t\t\t\t\t\t\t\t\tif (child instanceof THREE.Mesh) {\n\t\t\t\t\t\t\t\t\t\tif (self.styleParams.color != null) \n\t\t\t\t\t\t\t\t\t\t\tchild.material.color = color;\n\t\t\t\t\t\t\t\t\t\tif (self.styleParams.opacity != null) {\n\t\t\t\t\t\t\t\t\t\t\tchild.material.opacity = self.styleParams.opacity;\n\t\t\t\t\t\t\t\t\t\t\tchild.material.transparent = self.styleParams.opacity < 1.0 ? true : false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/*let children = gltf.scene.children;\n\t\t\t\t\t\t\tfor (let i=0; i<children.length; i++) {\n\t\t\t\t\t\t\t\tif (children[i].isObject3D) \n\t\t\t\t\t\t\t\t\tself.tileContent.add(children[i]);\n\t\t\t\t\t\t\t}*/\n\t\t\t\t\t\t\tself.tileContent.add(gltf.scene);\n\t\t\t\t\t\t}, function(e) {\n\t\t\t\t\t\t\tthrow new Error('error parsing gltf: ' + e);\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t} else if (type == 'pnts') {\n\t\t\t\tlet pnts = new PNTS(url);\n\t\t\t\tpnts.load()\n\t\t\t\t\t.then(d => {\n\t\t\t\t\t\tlet geometry = new THREE.BufferGeometry();\n\t\t\t\t\t\tgeometry.setAttribute('position', new THREE.Float32BufferAttribute(d.points, 3));\n\t\t\t\t\t\tlet material = new THREE.PointsMaterial();\n\t\t\t\t\t\tmaterial.size = self.styleParams.pointsize != null ? self.styleParams.pointsize : 1.0;\n\t\t\t\t\t\tif (self.styleParams.color) {\n\t\t\t\t\t\t\tmaterial.vertexColors = THREE.NoColors;\n\t\t\t\t\t\t\tmaterial.color = new THREE.Color(self.styleParams.color);\n\t\t\t\t\t\t\tmaterial.opacity = self.styleParams.opacity != null ? self.styleParams.opacity : 1.0;\n\t\t\t\t\t\t} else if (d.rgba) {\n\t\t\t\t\t\t\tgeometry.setAttribute('color', new THREE.Float32BufferAttribute(d.rgba, 4));\n\t\t\t\t\t\t\tmaterial.vertexColors = THREE.VertexColors;\n\t\t\t\t\t\t} else if (d.rgb) {\n\t\t\t\t\t\t\tgeometry.setAttribute('color', new THREE.Float32BufferAttribute(d.rgb, 3));\n\t\t\t\t\t\t\tmaterial.vertexColors = THREE.VertexColors;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.tileContent.add(new THREE.Points( geometry, material ));\n\t\t\t\t\t\tif (d.rtc_center) {\n\t\t\t\t\t\t\tlet c = d.rtc_center;\n\t\t\t\t\t\t\tself.tileContent.applyMatrix4(new THREE.Matrix4().makeTranslation(c[0], c[1], c[2]));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.tileContent.add(new THREE.Points( geometry, material ));\n\t\t\t\t\t});\n\t\t\t} else if (type == 'i3dm') {\n\t\t\t\tthrow new Error('i3dm tiles not yet implemented');\t\t\t\t\t\n\t\t\t} else if (type == 'cmpt') {\n\t\t\t\tthrow new Error('cmpt tiles not yet implemented');\n\t\t\t} else {\n\t\t\t\tthrow new Error('invalid tile type: ' + type);\n\t\t\t}\n\t\t}\n\t}\n\tunload(includeChildren) {\n\t\tthis.tileContent.visible = false;\n\t\tif (includeChildren) {\n\t\t\tthis.childContent.visible = false;\n\t\t} else  {\n\t\t\tthis.childContent.visible = true;\n\t\t}\n\t\t// TODO: should we also free up memory?\n\t}\n\tcheckLoad(frustum, cameraPosition) {\n\t\t// is this tile visible?\n\t\tif (!frustum.intersectsBox(this.box)) {\n\t\t\tthis.unload(true);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tlet dist = this.box.distanceToPoint(cameraPosition);\n\n\t\t//console.log(`dist: ${dist}, geometricError: ${this.geometricError}`);\n\t\t// are we too far to render this tile?\n\t\tif (this.geometricError > 0.0 && dist > this.geometricError * 50.0) {\n\t\t\tthis.unload(true);\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// should we load this tile?\n\t\tif (this.refine == 'REPLACE' && dist < this.geometricError * 20.0) {\n\t\t\tthis.unload(false);\n\t\t} else {\n\t\t\tthis.load();\n\t\t}\n\n\t\t// should we load its children?\n\t\tfor (let i=0; i<this.children.length; i++) {\n\t\t\tif (dist < this.geometricError * 20.0) {\n\t\t\t\tthis.children[i].checkLoad(frustum, cameraPosition);\n\t\t\t} else {\n\t\t\t\tthis.children[i].unload(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\t/*\n\t\t// below code loads tiles based on screenspace instead of geometricError,\n\t\t// not sure yet which algorith is better so i'm leaving this code here for now\n\t\tlet sw = this.box.min.clone().project(camera);\n\t\tlet ne = this.box.max.clone().project(camera);\t\t\t\n\t\tlet x1 = sw.x, x2 = ne.x;\n\t\tlet y1 = sw.y, y2 = ne.y;\n\t\tlet tilespace = Math.sqrt((x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1)); // distance in screen space\n\t\t\n\t\tif (tilespace < 0.2) {\n\t\t\tthis.unload();\n\t\t}\n\t\t// do nothing between 0.2 and 0.25 to avoid excessive tile loading/unloading\n\t\telse if (tilespace > 0.25) {\n\t\t\tthis.load();\n\t\t\tthis.children.forEach(child => {\n\t\t\t\tchild.checkLoad(camera);\n\t\t\t});\n\t\t}*/\n\t\t\n\t}\n}\n\nclass TileLoader {\n\t// This class contains the common code to load tile content, such as b3dm and pnts files.\n\t// It is not to be used directly. Instead, subclasses are used to implement specific \n\t// content loaders for different tile types.\n\tconstructor(url) {\n\t\tthis.url = url;\n\t\tthis.type = url.slice(-4);\n\t\tthis.version = null;\n\t\tthis.byteLength = null;\n\t\tthis.featureTableJSON = null;\n\t\tthis.featureTableBinary = null;\n\t\tthis.batchTableJson = null;\n\t\tthis.batchTableBinary = null;\n\t\tthis.binaryData = null;\n\t}\n\tload() {\n\t\tlet self = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfetch(self.url)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\tthrow new Error(`HTTP ${response.status} - ${response.statusText}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn response;\n\t\t\t\t})\n\t\t\t\t.then(response => response.arrayBuffer())\n\t\t\t\t.then(buffer => self.parseResponse(buffer))\n\t\t\t\t.then(res => resolve(res))\n\t\t\t\t.catch(error => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t});\t\t\n\t}\n\tparseResponse(buffer) {\n\t\tlet header = new Uint32Array(buffer.slice(0, 28));\n\t\tlet decoder = new TextDecoder();\n\t\tlet magic = decoder.decode(new Uint8Array(buffer.slice(0, 4)));\n\t\tif (magic != this.type) {\n\t\t\tthrow new Error(`Invalid magic string, expected '${this.type}', got '${this.magic}'`);\n\t\t}\n\t\tthis.version = header[1];\n\t\tthis.byteLength = header[2];\n\t\tlet featureTableJSONByteLength = header[3];\n\t\tlet featureTableBinaryByteLength = header[4];\n\t\tlet batchTableJsonByteLength = header[5];\n\t\tlet batchTableBinaryByteLength = header[6];\n\t\t\n\t\t/*\n\t\tconsole.log('magic: ' + magic);\n\t\tconsole.log('version: ' + this.version);\n\t\tconsole.log('featureTableJSONByteLength: ' + featureTableJSONByteLength);\n\t\tconsole.log('featureTableBinaryByteLength: ' + featureTableBinaryByteLength);\n\t\tconsole.log('batchTableJsonByteLength: ' + batchTableJsonByteLength);\n\t\tconsole.log('batchTableBinaryByteLength: ' + batchTableBinaryByteLength);\n\t\t*/\n\t\t\n\t\tlet pos = 28; // header length\n\t\tif (featureTableJSONByteLength > 0) {\n\t\t\tthis.featureTableJSON = JSON.parse(decoder.decode(new Uint8Array(buffer.slice(pos, pos+featureTableJSONByteLength))));\n\t\t\tpos += featureTableJSONByteLength;\n\t\t} else {\n\t\t\tthis.featureTableJSON = {};\n\t\t}\n\t\tthis.featureTableBinary = buffer.slice(pos, pos+featureTableBinaryByteLength);\n\t\tpos += featureTableBinaryByteLength;\n\t\tif (batchTableJsonByteLength > 0) {\n\t\t\tthis.batchTableJson = JSON.parse(decoder.decode(new Uint8Array(buffer.slice(pos, pos+batchTableJsonByteLength))));\n\t\t\tpos += batchTableJsonByteLength;\n\t\t} else {\n\t\t\tthis.batchTableJson = {};\n\t\t}\n\t\tthis.batchTableBinary = buffer.slice(pos, pos+batchTableBinaryByteLength);\n\t\tpos += batchTableBinaryByteLength;\n\t\tthis.binaryData = buffer.slice(pos);\n\t\treturn this;\n\t}\n}\n\nclass B3DM extends TileLoader {\n\tconstructor(url) {\n\t\tsuper(url);\n\t\tthis.glbData = null;\n\t}\n\tparseResponse(buffer) {\n\t\tsuper.parseResponse(buffer);\n\t\tthis.glbData = this.binaryData;\n\t\treturn this;\n\t}\n}\n\nclass PNTS extends TileLoader{\n\tconstructor(url) {\n\t\tsuper(url);\n\t\tthis.points = new Float32Array();\n\t\tthis.rgba = null;\n\t\tthis.rgb = null;\n\t}\n\tparseResponse(buffer) {\n\t\tsuper.parseResponse(buffer);\n\t\tif (this.featureTableJSON.POINTS_LENGTH && this.featureTableJSON.POSITION) {\n\t\t\tlet len = this.featureTableJSON.POINTS_LENGTH;\n\t\t\tlet pos = this.featureTableJSON.POSITION.byteOffset;\n\t\t\tthis.points = new Float32Array(this.featureTableBinary.slice(pos, pos + len * Float32Array.BYTES_PER_ELEMENT * 3));\n\t\t\tthis.rtc_center = this.featureTableJSON.RTC_CENTER;\n\t\t\tif (this.featureTableJSON.RGBA) {\n\t\t\t\tpos = this.featureTableJSON.RGBA.byteOffset;\n\t\t\t\tlet colorInts = new Uint8Array(this.featureTableBinary.slice(pos, pos + len * Uint8Array.BYTES_PER_ELEMENT * 4));\n\t\t\t\tlet rgba = new Float32Array(colorInts.length);\n\t\t\t\tfor (let i=0; i<colorInts.length; i++) {\n\t\t\t\t\trgba[i] = colorInts[i] / 255.0;\n\t\t\t\t}\n\t\t\t\tthis.rgba = rgba;\n\t\t\t} else if (this.featureTableJSON.RGB) {\n\t\t\t\tpos = this.featureTableJSON.RGB.byteOffset;\n\t\t\t\tlet colorInts = new Uint8Array(this.featureTableBinary.slice(pos, pos + len * Uint8Array.BYTES_PER_ELEMENT * 3));\n\t\t\t\tlet rgb = new Float32Array(colorInts.length);\n\t\t\t\tfor (let i=0; i<colorInts.length; i++) {\n\t\t\t\t\trgb[i] = colorInts[i] / 255.0;\n\t\t\t\t}\n\t\t\t\tthis.rgb = rgb;\n\t\t\t} else if (this.featureTableJSON.RGB565) {\n\t\t\t\tconsole.error('RGB565 is currently not supported in pointcloud tiles.')\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n}\n\n\nconst transform2mapbox = function (matrix) {\n\tconst min = -WEBMERCATOR_EXTENT;\n\tconst max = WEBMERCATOR_EXTENT;\n\tconst scale = 1 / (2 * WEBMERCATOR_EXTENT);\n\t\n\tlet result = matrix.slice(); // copy array\n\tresult[12] = (matrix[12] - min) * scale; // x translation\n\tresult[13] = (matrix[13] - max) * -scale; // y translation\n\tresult[14] = matrix[14] * scale; // z translation\n\t\n\treturn new THREE.Matrix4().fromArray(result).scale(new THREE.Vector3(scale, -scale, scale));\n}\n\nconst webmercator2mapbox = function(x, y, z) {\n\tconst min = -WEBMERCATOR_EXTENT;\n\tconst max = WEBMERCATOR_EXTENT;\n\tconst range = 2 * WEBMERCATOR_EXTENT;\n\t\n\treturn ([(x - min) / range, (y - max) / range * -1, z / range]);\n}\n\nclass Mapbox3DTileLayer {\n\tconstructor(params) {\n\t\tif (!params) throw new Error('parameters missing for mapbox 3D tiles layer');\n\t\tif (!params.id) throw new Error('id parameter missing for mapbox 3D tiles layer');\n\t\tif (!params.url) throw new Error('url parameter missing for mapbox 3D tiles layer');\n\t\t\n\t\tthis.id = params.id,\n\t\tthis.url = params.url;\n\t\tlet styleParams = {};\n\t\tif ('color' in params) styleParams.color = params.color;\n\t\tif ('opacity' in params) styleParams.opacity = params.opacity;\n\t\tif ('pointsize' in params) styleParams.pointsize = params.pointsize;\n\n\t\tthis.loadStatus = 0;\n\t\tthis.viewProjectionMatrix = null;\n\t\t\n\t\tthis.type = 'custom';\n\t\tthis.renderingMode = '3d';\n\t\t\n\t\tthis.getCameraPosition = function() {\n\t\t\tif (!this.viewProjectionMatrix)\n\t\t\t\treturn new THREE.Vector3();\n\t\t\tlet cam = new THREE.Camera();\n\t\t\tlet rootInverse = new THREE.Matrix4().getInverse(this.rootTransform);\n\t\t\tcam.projectionMatrix.elements = this.viewProjectionMatrix;\n\t\t\tcam.projectionMatrixInverse = new THREE.Matrix4().getInverse( cam.projectionMatrix );// add since three@0.103.0\n\t\t\tlet campos = new THREE.Vector3(0, 0, 0).unproject(cam).applyMatrix4(rootInverse);\n\t\t\treturn campos;\n\t\t}\n\t\t\n\t\tthis.onAdd = function(map, gl) {\n\t\t\tthis.map = map;\n\t\t\tthis.camera = new THREE.Camera();\n\t\t\tthis.scene = new THREE.Scene();\n\t\t\tthis.rootTransform = transform2mapbox([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]); // identity matrix tranformed to mapbox scale\n\n\t\t\tlet directionalLight = new THREE.DirectionalLight(0xffffff);\n\t\t\tdirectionalLight.position.set(0, -70, 100).normalize();\n\t\t\tthis.scene.add(directionalLight);\n\n\t\t\tlet directionalLight2 = new THREE.DirectionalLight(0x999999);\n\t\t\tdirectionalLight2.position.set(0, 70, 100).normalize();\n\t\t\tthis.scene.add(directionalLight2);\n\t\t\t\n\t\t\tthis.tileset = new TileSet();\n\t\t\tlet self = this;\n\t\t\tthis.tileset.load(this.url, styleParams).then(function(){\n\t\t\t\tif (self.tileset.root.transform) {\n\t\t\t\t\tself.rootTransform = transform2mapbox(self.tileset.root.transform);\n\t\t\t\t} else {\n\t\t\t\t\tself.rootTransform = transform2mapbox([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]); // identity matrix tranformed to mapbox scale\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (self.tileset.root) {\n\t\t\t\t\tself.scene.add(self.tileset.root.totalContent);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tself.loadStatus = 1;\n\t\t\t\tfunction refresh() {\n\t\t\t\t\tlet frustum = new THREE.Frustum();\n\t\t\t\t\tfrustum.setFromProjectionMatrix(new THREE.Matrix4().multiplyMatrices(self.camera.projectionMatrix, self.camera.matrixWorldInverse));\n\t\t\t\t\tself.tileset.root.checkLoad(frustum, self.getCameraPosition());\n\t\t\t\t};\n\t\t\t\tmap.on('dragend',refresh); \n\t\t\t\tmap.on('moveend',refresh); \n\t\t\t\tmap.on('load',refresh);\n\t\t\t});\n\t\t\t\n\t\t\tthis.renderer = new THREE.WebGLRenderer({\n\t\t\t\tcanvas: map.getCanvas(),\n\t\t\t\tcontext: gl\n\t\t\t});\n\t\t\tthis.renderer.autoClear = false;\n\n\n\t\t\t//this.skybox = Utils.loadSkybox(new URL('https://threejsfundamentals.org/threejs/resources/images/equirectangularmaps/tears_of_steel_bridge_2k.jpg').href);\n\n\t\t},\n\t\tthis.render = function(gl, viewProjectionMatrix) {\n\t\t\tthis.viewProjectionMatrix = viewProjectionMatrix;\n\t\t\tlet l = new THREE.Matrix4().fromArray(viewProjectionMatrix);\n\t\t\tthis.renderer.state.reset();\n\t\t\t\n\t\t\t// The root tile transform is applied to the camera while rendering\n\t\t\t// instead of to the root tile. This avoids precision errors.\n\t\t\tthis.camera.projectionMatrix = l.multiply(this.rootTransform);\n\t\t\t\n\t\t\t/*RENDER SKYBOX */\n\t\t\t/* WIP\n\t\t\tthis.skybox.camera.rotation.copy(this.camera.rotation);\n\t\t\tthis.skybox.camera.fov = this.camera.fov;\n\t\t\tthis.skybox.camera.aspect = this.camera.aspect;\n\t\t\tthis.skybox.camera.updateProjectionMatrix();\n\t\t\tthis.renderer.render(this.skybox.scene, this.skybox.camera);\n\t\t\t*/\n\t\t\tthis.renderer.render(this.scene, this.camera);\t\t\n\t\t\tif (this.loadStatus == 1) { // first render after root tile is loaded\n\t\t\t\tthis.loadStatus = 2;\n\t\t\t\tlet frustum = new THREE.Frustum();\n\t\t\t\tfrustum.setFromProjectionMatrix(new THREE.Matrix4().multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse));\n\t\t\t\tif (this.tileset.root) {\n\t\t\t\t\tthis.tileset.root.checkLoad(frustum, this.getCameraPosition());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport {Mapbox3DTileLayer}"],"names":[],"mappings":"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"}