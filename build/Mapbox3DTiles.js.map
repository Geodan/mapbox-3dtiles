{"version":3,"file":"Mapbox3DTiles.js","sources":["../src/Mapbox3DTiles.js","../index.js"],"sourcesContent":["export default function Mapbox3DTiles() {\n\t\n\tconst WEBMERCATOR_EXTENT = 20037508.3427892;\n\tconst THREE = window.THREE;\n\tconst DEBUG = false;\t\n\n\n\tclass TileSet {\n\t\tconstructor(){\n\t\t\tthis.url = null;\n\t\t\tthis.version = null;\n\t\t\tthis.gltfUpAxis = 'Z';\n\t\t\tthis.geometricError = null;\n\t\t\tthis.root = null;\n\t\t}\n\t\tload(url, styleParams) {\n\t\t\tthis.url = url;\n\t\t\tlet resourcePath = THREE.LoaderUtils.extractUrlBase(url);\n\t\t\tlet self = this;\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tfetch(self.url)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error(`HTTP ${response.status} - ${response.statusText}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t})\n\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t.then(json => {\n\t\t\t\t\t\tself.version = json.asset.version;\n\t\t\t\t\t\tself.geometricError = json.geometricError;\n\t\t\t\t\t\tself.refine = json.refine ? json.refine.toUpperCase() : 'ADD';\n\t\t\t\t\t\tself.root = new ThreeDeeTile(json.root, resourcePath, styleParams, self.refine, true);\n\t\t\t\t\t})\n\t\t\t\t\t.then(res => resolve())\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t\t}\n\t}\n\n\n\tclass ThreeDeeTile {\n\t\tconstructor(json, resourcePath, styleParams, parentRefine, isRoot) {\n\t\t\tthis.loaded = false;\n\t\t\tthis.styleParams = styleParams;\n\t\t\tthis.resourcePath = resourcePath;\n\t\t\tthis.totalContent = new THREE.Group();\t// Three JS Object3D Group for this tile and all its children\n\t\t\tthis.tileContent = new THREE.Group();\t\t// Three JS Object3D Group for this tile's content\n\t\t\tthis.childContent = new THREE.Group();\t\t// Three JS Object3D Group for this tile's children\n\t\t\tthis.totalContent.add(this.tileContent);\n\t\t\tthis.totalContent.add(this.childContent);\n\t\t\tthis.boundingVolume = json.boundingVolume;\n\t\t\tif (this.boundingVolume && this.boundingVolume.box) {\n\t\t\t\tlet b = this.boundingVolume.box;\n\t\t\t\tlet extent = [b[0] - b[3], b[1] - b[7], b[0] + b[3], b[1] + b[7]];\n\t\t\t\tlet sw = new THREE.Vector3(extent[0], extent[1], b[2] - b[11]);\n\t\t\t\tlet ne = new THREE.Vector3(extent[2], extent[3], b[2] + b[11]);\n\t\t\t\tthis.box = new THREE.Box3(sw, ne);\n\t\t\t\tif (DEBUG) {\n\t\t\t\t\tlet geom = new THREE.BoxGeometry(b[3] * 2, b[7] * 2, b[11] * 2);\n\t\t\t\t\tlet edges = new THREE.EdgesGeometry( geom );\n\t\t\t\t\tlet line = new THREE.LineSegments( edges, new THREE.LineBasicMaterial( { color: 0x800000 } ) );\n\t\t\t\t\tlet trans = new THREE.Matrix4().makeTranslation(b[0], b[1], b[2]);\n\t\t\t\t\tline.applyMatrix(trans);\n\t\t\t\t\tthis.totalContent.add(line);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.extent = null;\n\t\t\t\tthis.sw = null;\n\t\t\t\tthis.ne = null;\n\t\t\t\tthis.box = null;\n\t\t\t\tthis.center = null;\n\t\t\t}\n\t\t\tthis.refine = json.refine ? json.refine.toUpperCase() : parentRefine;\n\t\t\tthis.geometricError = json.geometricError;\n\t\t\tthis.transform = json.transform;\n\t\t\tif (this.transform && !isRoot) { \n\t\t\t\t// if not the root tile: apply the transform to the THREE js Group\n\t\t\t\t// the root tile transform is applied to the camera while rendering\n\t\t\t\tthis.totalContent.applyMatrix(new THREE.Matrix4().fromArray(this.transform));\n\t\t\t}\n\t\t\tthis.content = json.content;\n\t\t\tthis.children = [];\n\t\t\tif (json.children) {\n\t\t\t\tfor (let i=0; i<json.children.length; i++){\n\t\t\t\t\tlet child = new ThreeDeeTile(json.children[i], resourcePath, styleParams, this.refine, false);\n\t\t\t\t\tthis.childContent.add(child.totalContent);\n\t\t\t\t\tthis.children.push(child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tload() {\n\t\t\tthis.tileContent.visible = true;\n\t\t\tthis.childContent.visible = true;\n\t\t\tif (this.loaded) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.loaded = true;\n\t\t\tlet self = this;\n\t\t\tif (this.content) {\n\t\t\t\tlet url = this.content.uri ? this.content.uri : this.content.url;\n\t\t\t\tif (!url) return;\n\t\t\t\tif (url.substr(0, 4) != 'http')\n\t\t\t\t\turl = this.resourcePath + url;\n\t\t\t\tlet type = url.slice(-4);\n\t\t\t\tif (type == 'json') {\n\t\t\t\t\t// child is a tileset json\n\t\t\t\t\tlet tileset = new TileSet();\n\t\t\t\t\ttileset.load(url, this.styleParams).then(function(){\n\t\t\t\t\t\tself.children.push(tileset.root);\n\t\t\t\t\t\tif (tileset.root) {\n\t\t\t\t\t\t\tif (tileset.root.transform) {\n\t\t\t\t\t\t\t\t// the root tile transform of a tileset is normally not applied because\n\t\t\t\t\t\t\t\t// it is applied by the camera while rendering. However, in case the tileset \n\t\t\t\t\t\t\t\t// is a subset of another tileset, so the root tile transform must be applied \n\t\t\t\t\t\t\t\t// to the THREE js group of the root tile.\n\t\t\t\t\t\t\t\ttileset.root.totalContent.applyMatrix(new THREE.Matrix4().fromArray(tileset.root.transform));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.childContent.add(tileset.root.totalContent);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (type == 'b3dm') {\n\t\t\t\t\tlet loader = new THREE.GLTFLoader();\n\t\t\t\t\tlet b3dm = new B3DM(url);\n\t\t\t\t\tlet rotateX = new THREE.Matrix4().makeRotationAxis(new THREE.Vector3(1, 0, 0), Math.PI / 2);\n\t\t\t\t\tself.tileContent.applyMatrix(rotateX); // convert from GLTF Y-up to Z-up\n\t\t\t\t\tb3dm.load()\n\t\t\t\t\t\t.then(d => loader.parse(d.glbData, self.resourcePath, function(gltf) {\n\t\t\t\t\t\t\t\tif (self.styleParams.color != null || self.styleParams.opacity != null) {\n\t\t\t\t\t\t\t\t\tlet color = new THREE.Color(self.styleParams.color);\n\t\t\t\t\t\t\t\t\tgltf.scene.traverse(child => {\n\t\t\t\t\t\t\t\t\t\tif (child instanceof THREE.Mesh) {\n\t\t\t\t\t\t\t\t\t\t\tif (self.styleParams.color != null) \n\t\t\t\t\t\t\t\t\t\t\t\tchild.material.color = color;\n\t\t\t\t\t\t\t\t\t\t\tif (self.styleParams.opacity != null) {\n\t\t\t\t\t\t\t\t\t\t\t\tchild.material.opacity = self.styleParams.opacity;\n\t\t\t\t\t\t\t\t\t\t\t\tchild.material.transparent = self.styleParams.opacity < 1.0 ? true : false;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/*let children = gltf.scene.children;\n\t\t\t\t\t\t\t\tfor (let i=0; i<children.length; i++) {\n\t\t\t\t\t\t\t\t\tif (children[i].isObject3D) \n\t\t\t\t\t\t\t\t\t\tself.tileContent.add(children[i]);\n\t\t\t\t\t\t\t\t}*/\n\t\t\t\t\t\t\t\tself.tileContent.add(gltf.scene);\n\t\t\t\t\t\t\t}, function(e) {\n\t\t\t\t\t\t\t\tthrow new Error('error parsing gltf: ' + e);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t} else if (type == 'pnts') {\n\t\t\t\t\tlet pnts = new PNTS(url);\n\t\t\t\t\tpnts.load()\n\t\t\t\t\t\t.then(d => {\n\t\t\t\t\t\t\tlet geometry = new THREE.BufferGeometry();\n\t\t\t\t\t\t\tgeometry.addAttribute('position', new THREE.Float32BufferAttribute(d.points, 3));\n\t\t\t\t\t\t\tlet material = new THREE.PointsMaterial();\n\t\t\t\t\t\t\tmaterial.size = self.styleParams.pointsize != null ? self.styleParams.pointsize : 1.0;\n\t\t\t\t\t\t\tif (self.styleParams.color) {\n\t\t\t\t\t\t\t\tmaterial.vertexColors = THREE.NoColors;\n\t\t\t\t\t\t\t\tmaterial.color = new THREE.Color(self.styleParams.color);\n\t\t\t\t\t\t\t\tmaterial.opacity = self.styleParams.opacity != null ? self.styleParams.opacity : 1.0;\n\t\t\t\t\t\t\t} else if (d.rgba) {\n\t\t\t\t\t\t\t\tgeometry.addAttribute('color', new THREE.Float32BufferAttribute(d.rgba, 4));\n\t\t\t\t\t\t\t\tmaterial.vertexColors = THREE.VertexColors;\n\t\t\t\t\t\t\t} else if (d.rgb) {\n\t\t\t\t\t\t\t\tgeometry.addAttribute('color', new THREE.Float32BufferAttribute(d.rgb, 3));\n\t\t\t\t\t\t\t\tmaterial.vertexColors = THREE.VertexColors;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.tileContent.add(new THREE.Points( geometry, material ));\n\t\t\t\t\t\t\tif (d.rtc_center) {\n\t\t\t\t\t\t\t\tlet c = d.rtc_center;\n\t\t\t\t\t\t\t\tself.tileContent.applyMatrix(new THREE.Matrix4().makeTranslation(c[0], c[1], c[2]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.tileContent.add(new THREE.Points( geometry, material ));\n\t\t\t\t\t\t});\n\t\t\t\t} else if (type == 'i3dm') {\n\t\t\t\t\tthrow new Error('i3dm tiles not yet implemented');\t\t\t\t\t\n\t\t\t\t} else if (type == 'cmpt') {\n\t\t\t\t\tthrow new Error('cmpt tiles not yet implemented');\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('invalid tile type: ' + type);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tunload(includeChildren) {\n\t\t\tthis.tileContent.visible = false;\n\t\t\tif (includeChildren) {\n\t\t\t\tthis.childContent.visible = false;\n\t\t\t} else  {\n\t\t\t\tthis.childContent.visible = true;\n\t\t\t}\n\t\t\t// TODO: should we also free up memory?\n\t\t}\n\t\tcheckLoad(frustum, cameraPosition) {\n\t\t\t// is this tile visible?\n\t\t\tif (!frustum.intersectsBox(this.box)) {\n\t\t\t\tthis.unload(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet dist = this.box.distanceToPoint(cameraPosition);\n\n\t\t\t//console.log(`dist: ${dist}, geometricError: ${this.geometricError}`);\n\t\t\t// are we too far to render this tile?\n\t\t\tif (this.geometricError > 0.0 && dist > this.geometricError * 50.0) {\n\t\t\t\tthis.unload(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\t// should we load this tile?\n\t\t\tif (this.refine == 'REPLACE' && dist < this.geometricError * 20.0) {\n\t\t\t\tthis.unload(false);\n\t\t\t} else {\n\t\t\t\tthis.load();\n\t\t\t}\n\n\t\t\t// should we load its children?\n\t\t\tfor (let i=0; i<this.children.length; i++) {\n\t\t\t\tif (dist < this.geometricError * 20.0) {\n\t\t\t\t\tthis.children[i].checkLoad(frustum, cameraPosition);\n\t\t\t\t} else {\n\t\t\t\t\tthis.children[i].unload(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t/*\n\t\t\t// below code loads tiles based on screenspace instead of geometricError,\n\t\t\t// not sure yet which algorith is better so i'm leaving this code here for now\n\t\t\tlet sw = this.box.min.clone().project(camera);\n\t\t\tlet ne = this.box.max.clone().project(camera);\t\t\t\n\t\t\tlet x1 = sw.x, x2 = ne.x;\n\t\t\tlet y1 = sw.y, y2 = ne.y;\n\t\t\tlet tilespace = Math.sqrt((x2 - x1)*(x2 - x1) + (y2 - y1)*(y2 - y1)); // distance in screen space\n\t\t\t\n\t\t\tif (tilespace < 0.2) {\n\t\t\t\tthis.unload();\n\t\t\t}\n\t\t\t// do nothing between 0.2 and 0.25 to avoid excessive tile loading/unloading\n\t\t\telse if (tilespace > 0.25) {\n\t\t\t\tthis.load();\n\t\t\t\tthis.children.forEach(child => {\n\t\t\t\t\tchild.checkLoad(camera);\n\t\t\t\t});\n\t\t\t}*/\n\t\t\t\n\t\t}\n\t}\n\n\tclass TileLoader {\n\t\t// This class contains the common code to load tile content, such as b3dm and pnts files.\n\t\t// It is not to be used directly. Instead, subclasses are used to implement specific \n\t\t// content loaders for different tile types.\n\t\tconstructor(url) {\n\t\t\tthis.url = url;\n\t\t\tthis.type = url.slice(-4);\n\t\t\tthis.version = null;\n\t\t\tthis.byteLength = null;\n\t\t\tthis.featureTableJSON = null;\n\t\t\tthis.featureTableBinary = null;\n\t\t\tthis.batchTableJson = null;\n\t\t\tthis.batchTableBinary = null;\n\t\t\tthis.binaryData = null;\n\t\t}\n\t\tload() {\n\t\t\tlet self = this;\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tfetch(self.url)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error(`HTTP ${response.status} - ${response.statusText}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t})\n\t\t\t\t\t.then(response => response.arrayBuffer())\n\t\t\t\t\t.then(buffer => self.parseResponse(buffer))\n\t\t\t\t\t.then(res => resolve(res))\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t\t}\n\t\tparseResponse(buffer) {\n\t\t\tlet header = new Uint32Array(buffer.slice(0, 28));\n\t\t\tlet decoder = new TextDecoder();\n\t\t\tlet magic = decoder.decode(new Uint8Array(buffer.slice(0, 4)));\n\t\t\tif (magic != this.type) {\n\t\t\t\tthrow new Error(`Invalid magic string, expected '${this.type}', got '${this.magic}'`);\n\t\t\t}\n\t\t\tthis.version = header[1];\n\t\t\tthis.byteLength = header[2];\n\t\t\tlet featureTableJSONByteLength = header[3];\n\t\t\tlet featureTableBinaryByteLength = header[4];\n\t\t\tlet batchTableJsonByteLength = header[5];\n\t\t\tlet batchTableBinaryByteLength = header[6];\n\t\t\t\n\t\t\t/*\n\t\t\tconsole.log('magic: ' + magic);\n\t\t\tconsole.log('version: ' + this.version);\n\t\t\tconsole.log('featureTableJSONByteLength: ' + featureTableJSONByteLength);\n\t\t\tconsole.log('featureTableBinaryByteLength: ' + featureTableBinaryByteLength);\n\t\t\tconsole.log('batchTableJsonByteLength: ' + batchTableJsonByteLength);\n\t\t\tconsole.log('batchTableBinaryByteLength: ' + batchTableBinaryByteLength);\n\t\t\t*/\n\t\t\t\n\t\t\tlet pos = 28; // header length\n\t\t\tif (featureTableJSONByteLength > 0) {\n\t\t\t\tthis.featureTableJSON = JSON.parse(decoder.decode(new Uint8Array(buffer.slice(pos, pos+featureTableJSONByteLength))));\n\t\t\t\tpos += featureTableJSONByteLength;\n\t\t\t} else {\n\t\t\t\tthis.featureTableJSON = {};\n\t\t\t}\n\t\t\tthis.featureTableBinary = buffer.slice(pos, pos+featureTableBinaryByteLength);\n\t\t\tpos += featureTableBinaryByteLength;\n\t\t\tif (batchTableJsonByteLength > 0) {\n\t\t\t\tthis.batchTableJson = JSON.parse(decoder.decode(new Uint8Array(buffer.slice(pos, pos+batchTableJsonByteLength))));\n\t\t\t\tpos += batchTableJsonByteLength;\n\t\t\t} else {\n\t\t\t\tthis.batchTableJson = {};\n\t\t\t}\n\t\t\tthis.batchTableBinary = buffer.slice(pos, pos+batchTableBinaryByteLength);\n\t\t\tpos += batchTableBinaryByteLength;\n\t\t\tthis.binaryData = buffer.slice(pos);\n\t\t\treturn this;\n\t\t}\n\t}\n\t\n\tclass B3DM extends TileLoader {\n\t\tconstructor(url) {\n\t\t\tsuper(url);\n\t\t\tthis.glbData = null;\n\t\t}\n\t\tparseResponse(buffer) {\n\t\t\tsuper.parseResponse(buffer);\n\t\t\tthis.glbData = this.binaryData;\n\t\t\treturn this;\n\t\t}\n\t}\n\n\tclass PNTS extends TileLoader{\n\t\tconstructor(url) {\n\t\t\tsuper(url);\n\t\t\tthis.points = new Float32Array();\n\t\t\tthis.rgba = null;\n\t\t\tthis.rgb = null;\n\t\t}\n\t\tparseResponse(buffer) {\n\t\t\tsuper.parseResponse(buffer);\n\t\t\tif (this.featureTableJSON.POINTS_LENGTH && this.featureTableJSON.POSITION) {\n\t\t\t\tlet len = this.featureTableJSON.POINTS_LENGTH;\n\t\t\t\tlet pos = this.featureTableJSON.POSITION.byteOffset;\n\t\t\t\tthis.points = new Float32Array(this.featureTableBinary.slice(pos, pos + len * Float32Array.BYTES_PER_ELEMENT * 3));\n\t\t\t\tthis.rtc_center = this.featureTableJSON.RTC_CENTER;\n\t\t\t\tif (this.featureTableJSON.RGBA) {\n\t\t\t\t\tpos = this.featureTableJSON.RGBA.byteOffset;\n\t\t\t\t\tlet colorInts = new Uint8Array(this.featureTableBinary.slice(pos, pos + len * Uint8Array.BYTES_PER_ELEMENT * 4));\n\t\t\t\t\tlet rgba = new Float32Array(colorInts.length);\n\t\t\t\t\tfor (let i=0; i<colorInts.length; i++) {\n\t\t\t\t\t\trgba[i] = colorInts[i] / 255.0;\n\t\t\t\t\t}\n\t\t\t\t\tthis.rgba = rgba;\n\t\t\t\t} else if (this.featureTableJSON.RGB) {\n\t\t\t\t\tpos = this.featureTableJSON.RGB.byteOffset;\n\t\t\t\t\tlet colorInts = new Uint8Array(this.featureTableBinary.slice(pos, pos + len * Uint8Array.BYTES_PER_ELEMENT * 3));\n\t\t\t\t\tlet rgb = new Float32Array(colorInts.length);\n\t\t\t\t\tfor (let i=0; i<colorInts.length; i++) {\n\t\t\t\t\t\trgb[i] = colorInts[i] / 255.0;\n\t\t\t\t\t}\n\t\t\t\t\tthis.rgb = rgb;\n\t\t\t\t} else if (this.featureTableJSON.RGB565) {\n\t\t\t\t\tconsole.error('RGB565 is currently not supported in pointcloud tiles.')\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t}\n\n\n\tthis.transform2mapbox = function (matrix) {\n\t\tconst min = -WEBMERCATOR_EXTENT;\n\t\tconst max = WEBMERCATOR_EXTENT;\n\t\tconst scale = 1 / (2 * WEBMERCATOR_EXTENT);\n\t\t\n\t\tlet result = matrix.slice(); // copy array\n\t\tresult[12] = (matrix[12] - min) * scale; // x translation\n\t\tresult[13] = (matrix[13] - max) * -scale; // y translation\n\t\tresult[14] = matrix[14] * scale; // z translation\n\t\t\n\t\treturn new THREE.Matrix4().fromArray(result).scale(new THREE.Vector3(scale, -scale, scale));\n\t}\n\n\tthis.webmercator2mapbox = function(x, y, z) {\n\t\tconst min = -WEBMERCATOR_EXTENT;\n\t\tconst max = WEBMERCATOR_EXTENT;\n\t\tconst range = 2 * WEBMERCATOR_EXTENT;\n\t\t\n\t\treturn ([(x - min) / range, (y - max) / range * -1, z / range]);\n\t}\n\t\n\tthis.Layer = function(params) {\n\t\tif (!params) throw new Error('parameters missing for mapbox 3D tiles layer');\n\t\tif (!params.id) throw new Error('id parameter missing for mapbox 3D tiles layer');\n\t\tif (!params.url) throw new Error('url parameter missing for mapbox 3D tiles layer');\n\t\t\n\t\tthis.id = params.id,\n\t\tthis.url = params.url;\n\t\tlet styleParams = {};\n\t\tif ('color' in params) styleParams.color = params.color;\n\t\tif ('opacity' in params) styleParams.opacity = params.opacity;\n\t\tif ('pointsize' in params) styleParams.pointsize = params.pointsize;\n\n\t\tthis.loadStatus = 0;\n\t\tthis.viewProjectionMatrix = null;\n\t\t\n\t\tthis.type = 'custom';\n\t\tthis.renderingMode = '3d';\n\t\t\n\t\tthis.getCameraPosition = function() {\n\t\t\tif (!this.viewProjectionMatrix)\n\t\t\t\treturn new THREE.Vector3();\n\t\t\tlet cam = new THREE.Camera();\n\t\t\tlet rootInverse = new THREE.Matrix4().getInverse(this.rootTransform);\n\t\t\tcam.projectionMatrix.elements = this.viewProjectionMatrix;\n\t\t\tcam.projectionMatrixInverse = new THREE.Matrix4().getInverse( cam.projectionMatrix );// add since three@0.103.0\n\t\t\tlet campos = new THREE.Vector3(0, 0, 0).unproject(cam).applyMatrix4(rootInverse);\n\t\t\treturn campos;\n\t\t}\n\t\t\n\t\tthis.onAdd = function(map, gl) {\n\t\t\tthis.map = map;\n\t\t\tthis.camera = new THREE.Camera();\n\t\t\tthis.scene = new THREE.Scene();\n\t\t\tthis.rootTransform = transform2mapbox([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]); // identity matrix tranformed to mapbox scale\n\n\t\t\tlet directionalLight = new THREE.DirectionalLight(0xffffff);\n\t\t\tdirectionalLight.position.set(0, -70, 100).normalize();\n\t\t\tthis.scene.add(directionalLight);\n\n\t\t\tlet directionalLight2 = new THREE.DirectionalLight(0x999999);\n\t\t\tdirectionalLight2.position.set(0, 70, 100).normalize();\n\t\t\tthis.scene.add(directionalLight2);\n\t\t\t\n\t\t\tthis.tileset = new TileSet();\n\t\t\tlet self = this;\n\t\t\tthis.tileset.load(this.url, styleParams).then(function(){\n\t\t\t\tif (self.tileset.root.transform) {\n\t\t\t\t\tself.rootTransform = transform2mapbox(self.tileset.root.transform);\n\t\t\t\t} else {\n\t\t\t\t\tself.rootTransform = transform2mapbox([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]); // identity matrix tranformed to mapbox scale\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (self.tileset.root) {\n\t\t\t\t\tself.scene.add(self.tileset.root.totalContent);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tself.loadStatus = 1;\n\t\t\t\tfunction refresh() {\n\t\t\t\t\tlet frustum = new THREE.Frustum();\n\t\t\t\t\tfrustum.setFromMatrix(new THREE.Matrix4().multiplyMatrices(self.camera.projectionMatrix, self.camera.matrixWorldInverse));\n\t\t\t\t\tself.tileset.root.checkLoad(frustum, self.getCameraPosition());\n\t\t\t\t};\n\t\t\t\tmap.on('dragend',refresh); \n\t\t\t\tmap.on('moveend',refresh); \n\t\t\t});\n\t\t\t\n\t\t\tthis.renderer = new THREE.WebGLRenderer({\n\t\t\t\tcanvas: map.getCanvas(),\n\t\t\t\tcontext: gl\n\t\t\t});\n\t\t\tthis.renderer.autoClear = false;\n\t\t},\n\t\tthis.render = function(gl, viewProjectionMatrix) {\n\t\t\tthis.viewProjectionMatrix = viewProjectionMatrix;\n\t\t\tlet l = new THREE.Matrix4().fromArray(viewProjectionMatrix);\n\t\t\tthis.renderer.state.reset();\n\t\t\t\n\t\t\t// The root tile transform is applied to the camera while rendering\n\t\t\t// instead of to the root tile. This avoids precision errors.\n\t\t\tthis.camera.projectionMatrix = l.multiply(this.rootTransform);\n\t\t\t\t\n\t\t\tthis.renderer.render(this.scene, this.camera);\t\t\n\t\t\tif (this.loadStatus == 1) { // first render after root tile is loaded\n\t\t\t\tthis.loadStatus = 2;\n\t\t\t\tlet frustum = new THREE.Frustum();\n\t\t\t\tfrustum.setFromMatrix(new THREE.Matrix4().multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse));\n\t\t\t\tif (this.tileset.root) {\n\t\t\t\t\tthis.tileset.root.checkLoad(frustum, this.getCameraPosition());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import Mapbox3DTiles from './src/Mapbox3DTiles.js'\n\nwindow.Mapbox3DTiles = Mapbox3DTiles;\n"],"names":[],"mappings":"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"}